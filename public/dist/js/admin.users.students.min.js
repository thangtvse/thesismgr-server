var students={},hash=window.location.hash,page=1,numberOfPages=$("#number-of-pages").text();$(document).ready(function(){hash&&"#page"==hash.substring(0,5)&&(page=parseInt(hash.substring(6))),console.log(page),$("#pagination").pagination({items:numberOfPages,itemOnPage:8,currentPage:page,cssStyle:"",prevText:'<span aria-hidden="true">&laquo;</span>',nextText:'<span aria-hidden="true">&raquo;</span>',onInit:function(){getData()},onPageClick:function(t,e){page=t,window.location.hash="#page-"+page,console.log(page),null==students[page]?getData():setDataToTable()}}),configCourseAndProgram(),$("#faculty_id").change(function(){configCourseAndProgram()}),configCourseAndProgramForUpdate(),$("#update-faculty-id").change(function(){configCourseAndProgramForUpdate()}),$("#btn-update-submit").click(function(t){t.preventDefault(),updateInfo()})});var configCourseAndProgram=function(){var t=$("#faculty_id").val(),e=!1;$(".course-option-item").each(function(a,n){$(this).attr("data-faculty-id")!=t?($(this).hide(),$(this).attr("selected",!1)):($(this).show(),0==e&&($(this).attr("selected",!0),e=!0))});var a=!1;$(".program-option-item").each(function(e,n){$(this).attr("data-faculty-id")!=t?($(this).hide(),$(this).attr("selected",!1)):($(this).show(),0==a&&($(this).attr("selected",!0),a=!0))})},configCourseAndProgramForUpdate=function(){var t=$("#update-faculty-id").val(),e=!1;$(".update-course-option-item").each(function(a,n){$(this).attr("data-faculty-id")!=t?($(this).hide(),$(this).attr("selected",!1)):($(this).show(),0==e&&($(this).attr("selected",!0),e=!0))});var a=!1;$(".update-program-option-item").each(function(e,n){$(this).attr("data-faculty-id")!=t?($(this).hide(),$(this).attr("selected",!1)):($(this).show(),0==a&&($(this).attr("selected",!0),a=!0))})},getData=function(){var t={page:page};"moderator"==$("#current-role").text()&&(t.faculty_id=$("#current-facultyID").text()),$.ajax({url:"/admin/users/api/students",method:"GET",data:t,success:function(t){1==t.status?(console.log(t),students[page]=[],t.data.forEach(function(t){students[page].push(t)}),setDataToTable(10*(page-1),t.data.length)):$.toast({heading:"Error",text:t.message,icon:"error"})},error:errorHandler})},updateInfo=function(){$.ajax({url:"/admin/users/api/students/update",method:"POST",data:{officer_number:$("#update-officer-number").val(),email:$("#update-email").val(),faculty_id:$("#update-faculty-id").val(),course_id:$("#update-course-id").val(),program_id:$("#update-program-id").val(),full_name:$("#update-full-name").val(),thesis_registrable:"true"==$("#update-thesis-registrble").val()},success:function(t){if(console.log(t.data),$("#update-student-modal").modal("hide"),1==t.status){for(var e=0;e<=students[page].length;e++)if(students[page][e].id==t.data.id){students[page][e]=t.data;break}console.log(students),setDataToTable()}else $.toast({heading:"Error",text:t.message,icon:"error"})},error:errorHandler})},setDataToTable=function(){$(".table.table-body").children().remove(),students[page].forEach(function(t){if(null!=t.student){var e="NO";t.student.thesisRegistrable&&(e="YES"),$("#table-students").append("<tr><td>"+t.officerNumber+"</td><td>"+t.fullName+"</td><td>"+t.email+"</td><td>"+t.faculty.name+"</td><td>"+t.student.course.name+"</td><td>"+t.student.program.name+"</td><td>"+e+"</td><td><a onclick=\"editStudent(event,'"+t.id+"')\">Edit</a></td></tr>")}})},editStudent=function(t,e){t.preventDefault();var a;for(var n in students)if(a=$.grep(students[n],function(t){return t.id==e})[0],null!=a)break;$("#update-officer-number").val(a.officerNumber),$("#update-email").val(a.email),$("#update-faculty-id").val(a.faculty.id),$("#update-course-id").val(a.student.course.id),$("#update-program-id").val(a.student.program.id),$("#update-full-name").val(a.fullName),$("#update-thesis-registrble").val(a.student.thesisRegistrable?"true":"false"),$("#update-student-modal").modal("show")};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLnVzZXJzLnN0dWRlbnRzLmpzIl0sIm5hbWVzIjpbInN0dWRlbnRzIiwiaGFzaCIsIndpbmRvdyIsImxvY2F0aW9uIiwicGFnZSIsIm51bWJlck9mUGFnZXMiLCIkIiwidGV4dCIsImRvY3VtZW50IiwicmVhZHkiLCJzdWJzdHJpbmciLCJwYXJzZUludCIsImNvbnNvbGUiLCJsb2ciLCJwYWdpbmF0aW9uIiwiaXRlbXMiLCJpdGVtT25QYWdlIiwiY3VycmVudFBhZ2UiLCJjc3NTdHlsZSIsInByZXZUZXh0IiwibmV4dFRleHQiLCJvbkluaXQiLCJnZXREYXRhIiwib25QYWdlQ2xpY2siLCJldnQiLCJzZXREYXRhVG9UYWJsZSIsImNvbmZpZ0NvdXJzZUFuZFByb2dyYW0iLCJjaGFuZ2UiLCJjb25maWdDb3Vyc2VBbmRQcm9ncmFtRm9yVXBkYXRlIiwiY2xpY2siLCJlIiwicHJldmVudERlZmF1bHQiLCJ1cGRhdGVJbmZvIiwiZmFjdWx0eUlEIiwidmFsIiwiY291cnNlU2VsZWN0ZWQiLCJlYWNoIiwiaW5kZXgiLCJlbGVtZW50IiwidGhpcyIsImF0dHIiLCJoaWRlIiwic2hvdyIsInByb2dyYW1TZWxlY3RlZCIsImRhdGEiLCJmYWN1bHR5X2lkIiwiYWpheCIsInVybCIsIm1ldGhvZCIsInN1Y2Nlc3MiLCJyZXNwb25zZSIsInN0YXR1cyIsImZvckVhY2giLCJzdHVkZW50IiwicHVzaCIsImxlbmd0aCIsInRvYXN0IiwiaGVhZGluZyIsIm1lc3NhZ2UiLCJpY29uIiwiZXJyb3IiLCJlcnJvckhhbmRsZXIiLCJvZmZpY2VyX251bWJlciIsImVtYWlsIiwiY291cnNlX2lkIiwicHJvZ3JhbV9pZCIsImZ1bGxfbmFtZSIsInRoZXNpc19yZWdpc3RyYWJsZSIsIm1vZGFsIiwiaSIsImlkIiwiY2hpbGRyZW4iLCJyZW1vdmUiLCJyZWdpc3RyYWJsZSIsInRoZXNpc1JlZ2lzdHJhYmxlIiwiYXBwZW5kIiwib2ZmaWNlck51bWJlciIsImZ1bGxOYW1lIiwiZmFjdWx0eSIsIm5hbWUiLCJjb3Vyc2UiLCJwcm9ncmFtIiwiZWRpdFN0dWRlbnQiLCJzdHVkZW50SUQiLCJncmVwIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxhQUNBQyxLQUFPQyxPQUFPQyxTQUFTRixLQUN2QkcsS0FBTyxFQUNQQyxjQUFnQkMsRUFBRSxvQkFBb0JDLE1BRTFDRCxHQUFFRSxVQUFVQyxNQUFNLFdBRVZSLE1BQWdDLFNBQXhCQSxLQUFLUyxVQUFVLEVBQUcsS0FDMUJOLEtBQU9PLFNBQVNWLEtBQUtTLFVBQVUsS0FHbkNFLFFBQVFDLElBQUlULE1BRVpFLEVBQUUsZUFBZVEsWUFDYkMsTUFBT1YsY0FDUFcsV0FBWSxFQUNaQyxZQUFhYixLQUNiYyxTQUFVLEdBQ1ZDLFNBQVUsMENBQ1ZDLFNBQVUsMENBQ1ZDLE9BQVEsV0FFSkMsV0FFSkMsWUFBYSxTQUFVTixFQUFhTyxHQUVoQ3BCLEtBQU9hLEVBQ1BmLE9BQU9DLFNBQVNGLEtBQU8sU0FBV0csS0FDbENRLFFBQVFDLElBQUlULE1BQ1UsTUFBbEJKLFNBQVNJLE1BQ1RrQixVQUVBRyxvQkFTWkMseUJBRUFwQixFQUFFLGVBQWVxQixPQUFPLFdBQ3BCRCwyQkFJSkUsa0NBRUF0QixFQUFFLHNCQUFzQnFCLE9BQU8sV0FDM0JDLG9DQUlKdEIsRUFBRSxzQkFBc0J1QixNQUFNLFNBQVVDLEdBQ3BDQSxFQUFFQyxpQkFDRkMsZ0JBT1IsSUFBSU4sd0JBQXlCLFdBQ3pCLEdBQUlPLEdBQVkzQixFQUFFLGVBQWU0QixNQUU3QkMsR0FBaUIsQ0FFckI3QixHQUFFLHVCQUF1QjhCLEtBQUssU0FBVUMsRUFBT0MsR0FDdkNoQyxFQUFFaUMsTUFBTUMsS0FBSyxvQkFBc0JQLEdBQ25DM0IsRUFBRWlDLE1BQU1FLE9BQ1JuQyxFQUFFaUMsTUFBTUMsS0FBSyxZQUFZLEtBRXpCbEMsRUFBRWlDLE1BQU1HLE9BQ2MsR0FBbEJQLElBQ0E3QixFQUFFaUMsTUFBTUMsS0FBSyxZQUFZLEdBQ3pCTCxHQUFpQixLQUs3QixJQUFJUSxJQUFrQixDQUV0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QUNkcEIsR0FBUUEsUUFBUXFCLG9CQUNoQkQsRUFBYyxPQUdsQm5FLEVBQUUsbUJBQW1CcUUsT0FBTyxXQUNmdEIsRUFBUXVCLGNBQWdCLFlBQ3hCdkIsRUFBUXdCLFNBQVcsWUFDbkJ4QixFQUFRVSxNQUFRLFlBQ2hCVixFQUFReUIsUUFBUUMsS0FBTyxZQUN2QjFCLEVBQVFBLFFBQVEyQixPQUFPRCxLQUFPLFlBQzlCMUIsRUFBUUEsUUFBUTRCLFFBQVFGLEtBQU8sWUFDL0JOLEVBQWMsNENBQ2tCcEIsRUFBUWlCLEdBQUssK0JBV2xFWSxZQUFjLFNBQVVwRCxFQUFHcUQsR0FDM0JyRCxFQUFFQyxnQkFFRixJQUFJc0IsRUFFSixLQUFLLEdBQUlqRCxLQUFRSixVQUtiLEdBSkFxRCxFQUFVL0MsRUFBRThFLEtBQUtwRixTQUFTSSxHQUFPLFNBQVUwQixHQUN2QyxNQUFPQSxHQUFFd0MsSUFBTWEsSUFDaEIsR0FFWSxNQUFYOUIsRUFDQSxLQUlSL0MsR0FBRSwwQkFBMEI0QixJQUFJbUIsRUFBUXVCLGVBQ3hDdEUsRUFBRSxpQkFBaUI0QixJQUFJbUIsRUFBUVUsT0FDL0J6RCxFQUFFLHNCQUFzQjRCLElBQUltQixFQUFReUIsUUFBUVIsSUFDNUNoRSxFQUFFLHFCQUFxQjRCLElBQUltQixFQUFRQSxRQUFRMkIsT0FBT1YsSUFDbERoRSxFQUFFLHNCQUFzQjRCLElBQUltQixFQUFRQSxRQUFRNEIsUUFBUVgsSUFDcERoRSxFQUFFLHFCQUFxQjRCLElBQUltQixFQUFRd0IsVUFDbkN2RSxFQUFFLDZCQUE2QjRCLElBQUltQixFQUFRQSxRQUFRcUIsa0JBQW9CLE9BQVMsU0FDaEZwRSxFQUFFLHlCQUF5QjhELE1BQU0iLCJmaWxlIjoiYWRtaW4udXNlcnMuc3R1ZGVudHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHN0dWRlbnRzID0ge307XHJcbnZhciBoYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2g7XHJcbnZhciBwYWdlID0gMTtcclxudmFyIG51bWJlck9mUGFnZXMgPSAkKFwiI251bWJlci1vZi1wYWdlc1wiKS50ZXh0KCk7XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgaWYgKGhhc2ggJiYgaGFzaC5zdWJzdHJpbmcoMCwgNSkgPT0gJyNwYWdlJykge1xyXG4gICAgICAgIHBhZ2UgPSBwYXJzZUludChoYXNoLnN1YnN0cmluZyg2KSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2cocGFnZSk7XHJcblxyXG4gICAgJCgnI3BhZ2luYXRpb24nKS5wYWdpbmF0aW9uKHtcclxuICAgICAgICBpdGVtczogbnVtYmVyT2ZQYWdlcyxcclxuICAgICAgICBpdGVtT25QYWdlOiA4LFxyXG4gICAgICAgIGN1cnJlbnRQYWdlOiBwYWdlLFxyXG4gICAgICAgIGNzc1N0eWxlOiAnJyxcclxuICAgICAgICBwcmV2VGV4dDogJzxzcGFuIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPiZsYXF1bzs8L3NwYW4+JyxcclxuICAgICAgICBuZXh0VGV4dDogJzxzcGFuIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPiZyYXF1bzs8L3NwYW4+JyxcclxuICAgICAgICBvbkluaXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gZmlyZSBmaXJzdCBwYWdlIGxvYWRpbmdcclxuICAgICAgICAgICAgZ2V0RGF0YSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25QYWdlQ2xpY2s6IGZ1bmN0aW9uIChjdXJyZW50UGFnZSwgZXZ0KSB7XHJcbiAgICAgICAgICAgIC8vIHNvbWUgY29kZVxyXG4gICAgICAgICAgICBwYWdlID0gY3VycmVudFBhZ2U7XHJcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gXCIjcGFnZS1cIiArIHBhZ2U7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHBhZ2UpO1xyXG4gICAgICAgICAgICBpZiAoc3R1ZGVudHNbcGFnZV0gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgZ2V0RGF0YSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2V0RGF0YVRvVGFibGUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIC8vIGNvbmZpZyBjb3Vyc2UgYW5kIHByb2dyYW0gZm9yIGFkZC1uZXctc3R1ZGVudCBtb2RhbFxyXG4gICAgY29uZmlnQ291cnNlQW5kUHJvZ3JhbSgpO1xyXG5cclxuICAgICQoXCIjZmFjdWx0eV9pZFwiKS5jaGFuZ2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbmZpZ0NvdXJzZUFuZFByb2dyYW0oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGNvbmZpZyBjb3Vyc2UgYW5kIHByb2dyYW0gZm9yIHVwZGF0ZSBtb2RhbFxyXG4gICAgY29uZmlnQ291cnNlQW5kUHJvZ3JhbUZvclVwZGF0ZSgpO1xyXG5cclxuICAgICQoXCIjdXBkYXRlLWZhY3VsdHktaWRcIikuY2hhbmdlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25maWdDb3Vyc2VBbmRQcm9ncmFtRm9yVXBkYXRlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBzdWJtaXQgdXBkYXRlZCBpbmZvXHJcbiAgICAkKFwiI2J0bi11cGRhdGUtc3VibWl0XCIpLmNsaWNrKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHVwZGF0ZUluZm8oKTtcclxuICAgIH0pXHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIENvbmZpZyBjb3Vyc2UgYW5kIHByb2dyYW0gZm9yIGFkZC1uZXctc3R1ZGVudC1tb2RhbCB0aGF0IGZpdCB3aXRoIGZhY3VsdHlcclxuICovXHJcbnZhciBjb25maWdDb3Vyc2VBbmRQcm9ncmFtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGZhY3VsdHlJRCA9ICQoXCIjZmFjdWx0eV9pZFwiKS52YWwoKTtcclxuXHJcbiAgICB2YXIgY291cnNlU2VsZWN0ZWQgPSBmYWxzZTtcclxuXHJcbiAgICAkKFwiLmNvdXJzZS1vcHRpb24taXRlbVwiKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAgIGlmICgkKHRoaXMpLmF0dHIoXCJkYXRhLWZhY3VsdHktaWRcIikgIT0gZmFjdWx0eUlEKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuaGlkZSgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLmF0dHIoXCJzZWxlY3RlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5zaG93KCk7XHJcbiAgICAgICAgICAgIGlmIChjb3Vyc2VTZWxlY3RlZCA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hdHRyKFwic2VsZWN0ZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBjb3Vyc2VTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgcHJvZ3JhbVNlbGVjdGVkID0gZmFsc2U7XHJcblxyXG4gICAgJChcIi5wcm9ncmFtLW9wdGlvbi1pdGVtXCIpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCQodGhpcykuYXR0cihcImRhdGEtZmFjdWx0eS1pZFwiKSAhPSBmYWN1bHR5SUQpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICQodGhpcykuYXR0cihcInNlbGVjdGVkXCIsIGZhbHNlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnNob3coKTtcclxuICAgICAgICAgICAgaWYgKHByb2dyYW1TZWxlY3RlZCA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hdHRyKFwic2VsZWN0ZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBwcm9ncmFtU2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDb25maWcgY291cnNlIGFuZCBwcm9ncmFtIGZvciB1cGRhdGUgbW9kYWwgdGhhdCBmaXQgd2l0aCBmYWN1bHR5XHJcbiAqL1xyXG52YXIgY29uZmlnQ291cnNlQW5kUHJvZ3JhbUZvclVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBmYWN1bHR5SUQgPSAkKFwiI3VwZGF0ZS1mYWN1bHR5LWlkXCIpLnZhbCgpO1xyXG5cclxuICAgIHZhciBjb3Vyc2VTZWxlY3RlZCA9IGZhbHNlO1xyXG5cclxuICAgICQoXCIudXBkYXRlLWNvdXJzZS1vcHRpb24taXRlbVwiKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAgIGlmICgkKHRoaXMpLmF0dHIoXCJkYXRhLWZhY3VsdHktaWRcIikgIT0gZmFjdWx0eUlEKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuaGlkZSgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLmF0dHIoXCJzZWxlY3RlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5zaG93KCk7XHJcbiAgICAgICAgICAgIGlmIChjb3Vyc2VTZWxlY3RlZCA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hdHRyKFwic2VsZWN0ZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBjb3Vyc2VTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgcHJvZ3JhbVNlbGVjdGVkID0gZmFsc2U7XHJcblxyXG4gICAgJChcIi51cGRhdGUtcHJvZ3JhbS1vcHRpb24taXRlbVwiKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAgIGlmICgkKHRoaXMpLmF0dHIoXCJkYXRhLWZhY3VsdHktaWRcIikgIT0gZmFjdWx0eUlEKSB7XHJcbiAgICAgICAgICAgICQodGhpcykuaGlkZSgpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLmF0dHIoXCJzZWxlY3RlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5zaG93KCk7XHJcbiAgICAgICAgICAgIGlmIChwcm9ncmFtU2VsZWN0ZWQgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICQodGhpcykuYXR0cihcInNlbGVjdGVkXCIsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgcHJvZ3JhbVNlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IGRhdGEgZnJvbSBzZXJ2ZXJcclxuICovXHJcbnZhciBnZXREYXRhID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgIHBhZ2U6IHBhZ2VcclxuICAgIH07XHJcblxyXG4gICAgaWYgKCQoXCIjY3VycmVudC1yb2xlXCIpLnRleHQoKSA9PSBcIm1vZGVyYXRvclwiKSB7XHJcbiAgICAgICAgZGF0YS5mYWN1bHR5X2lkID0gJChcIiNjdXJyZW50LWZhY3VsdHlJRFwiKS50ZXh0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgJC5hamF4KHtcclxuICAgICAgICB1cmw6IFwiL2FkbWluL3VzZXJzL2FwaS9zdHVkZW50c1wiLFxyXG4gICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICBkYXRhOiBkYXRhLFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IHRydWUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgc3R1ZGVudHNbcGFnZV0gPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXNwb25zZS5kYXRhLmZvckVhY2goZnVuY3Rpb24gKHN0dWRlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHVkZW50c1twYWdlXS5wdXNoKHN0dWRlbnQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgc2V0RGF0YVRvVGFibGUoKHBhZ2UgLSAxKSAqIDEwLCByZXNwb25zZS5kYXRhLmxlbmd0aCk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJC50b2FzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGluZzogJ0Vycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiByZXNwb25zZS5tZXNzYWdlLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb246ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlcnJvcjogZXJyb3JIYW5kbGVyXHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgaW5mbyBmb3IgY3VycmVudCBzdHVkZW50XHJcbiAqL1xyXG52YXIgdXBkYXRlSW5mbyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICQuYWpheCh7XHJcbiAgICAgICAgdXJsOiBcIi9hZG1pbi91c2Vycy9hcGkvc3R1ZGVudHMvdXBkYXRlXCIsXHJcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgIG9mZmljZXJfbnVtYmVyOiAkKFwiI3VwZGF0ZS1vZmZpY2VyLW51bWJlclwiKS52YWwoKSxcclxuICAgICAgICAgICAgZW1haWw6ICQoXCIjdXBkYXRlLWVtYWlsXCIpLnZhbCgpLFxyXG4gICAgICAgICAgICBmYWN1bHR5X2lkOiAkKFwiI3VwZGF0ZS1mYWN1bHR5LWlkXCIpLnZhbCgpLFxyXG4gICAgICAgICAgICBjb3Vyc2VfaWQ6ICQoXCIjdXBkYXRlLWNvdXJzZS1pZFwiKS52YWwoKSxcclxuICAgICAgICAgICAgcHJvZ3JhbV9pZDogJChcIiN1cGRhdGUtcHJvZ3JhbS1pZFwiKS52YWwoKSxcclxuICAgICAgICAgICAgZnVsbF9uYW1lOiAkKFwiI3VwZGF0ZS1mdWxsLW5hbWVcIikudmFsKCksXHJcbiAgICAgICAgICAgIHRoZXNpc19yZWdpc3RyYWJsZTogJChcIiN1cGRhdGUtdGhlc2lzLXJlZ2lzdHJibGVcIikudmFsKCkgPT0gXCJ0cnVlXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAkKFwiI3VwZGF0ZS1zdHVkZW50LW1vZGFsXCIpLm1vZGFsKCdoaWRlJyk7XHJcblxyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IHRydWUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBzdHVkZW50c1twYWdlXS5sZW5ndGg7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3R1ZGVudHNbcGFnZV1baV0uaWQgPT0gcmVzcG9uc2UuZGF0YS5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImJlZm9yZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc3R1ZGVudHNbcGFnZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHVkZW50c1twYWdlXVtpXSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiYWZ0ZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHN0dWRlbnRzW3BhZ2VdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0dWRlbnRzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZXREYXRhVG9UYWJsZSgpO1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICQudG9hc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRpbmc6ICdFcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogcmVzcG9uc2UubWVzc2FnZSxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXJyb3I6IGVycm9ySGFuZGxlclxyXG4gICAgfSlcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTZXQgZGF0YSB0byB0YWJsZVxyXG4gKi9cclxudmFyIHNldERhdGFUb1RhYmxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgJCgnLnRhYmxlLnRhYmxlLWJvZHknKS5jaGlsZHJlbigpLnJlbW92ZSgpO1xyXG5cclxuICAgIHN0dWRlbnRzW3BhZ2VdLmZvckVhY2goZnVuY3Rpb24gKHN0dWRlbnQpIHtcclxuICAgICAgICBpZiAoc3R1ZGVudC5zdHVkZW50ICE9IG51bGwpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciByZWdpc3RyYWJsZSA9IFwiTk9cIjtcclxuICAgICAgICAgICAgaWYgKHN0dWRlbnQuc3R1ZGVudC50aGVzaXNSZWdpc3RyYWJsZSkge1xyXG4gICAgICAgICAgICAgICAgcmVnaXN0cmFibGUgPSBcIllFU1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICQoJyN0YWJsZS1zdHVkZW50cycpLmFwcGVuZCgnPHRyPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD4nICsgc3R1ZGVudC5vZmZpY2VyTnVtYmVyICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPicgKyBzdHVkZW50LmZ1bGxOYW1lICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPicgKyBzdHVkZW50LmVtYWlsICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPicgKyBzdHVkZW50LmZhY3VsdHkubmFtZSArICc8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD4nICsgc3R1ZGVudC5zdHVkZW50LmNvdXJzZS5uYW1lICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPicgKyBzdHVkZW50LnN0dWRlbnQucHJvZ3JhbS5uYW1lICsgJzwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPHRkPicgKyByZWdpc3RyYWJsZSArICc8L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZD48YSBvbmNsaWNrPVwiZWRpdFN0dWRlbnQoZXZlbnQsXFwnJyArIHN0dWRlbnQuaWQgKyAnXFwnKVwiPkVkaXQ8L2E+PC90ZD4nICtcclxuICAgICAgICAgICAgICAgICc8L3RyPidcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIE9wZW4gYSBtb2RhbCBhbGxvd3MgdXMgdG8gdXBkYXRlIHN0dWRlbnQgaW5mb1xyXG4gKiBAcGFyYW0gc3R1ZGVudElEXHJcbiAqL1xyXG52YXIgZWRpdFN0dWRlbnQgPSBmdW5jdGlvbiAoZSwgc3R1ZGVudElEKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgdmFyIHN0dWRlbnQ7XHJcblxyXG4gICAgZm9yICh2YXIgcGFnZSBpbiBzdHVkZW50cykge1xyXG4gICAgICAgIHN0dWRlbnQgPSAkLmdyZXAoc3R1ZGVudHNbcGFnZV0sIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlLmlkID09IHN0dWRlbnRJRDtcclxuICAgICAgICB9KVswXTtcclxuXHJcbiAgICAgICAgaWYgKHN0dWRlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgJChcIiN1cGRhdGUtb2ZmaWNlci1udW1iZXJcIikudmFsKHN0dWRlbnQub2ZmaWNlck51bWJlcik7XHJcbiAgICAkKFwiI3VwZGF0ZS1lbWFpbFwiKS52YWwoc3R1ZGVudC5lbWFpbCk7XHJcbiAgICAkKFwiI3VwZGF0ZS1mYWN1bHR5LWlkXCIpLnZhbChzdHVkZW50LmZhY3VsdHkuaWQpO1xyXG4gICAgJChcIiN1cGRhdGUtY291cnNlLWlkXCIpLnZhbChzdHVkZW50LnN0dWRlbnQuY291cnNlLmlkKTtcclxuICAgICQoXCIjdXBkYXRlLXByb2dyYW0taWRcIikudmFsKHN0dWRlbnQuc3R1ZGVudC5wcm9ncmFtLmlkKTtcclxuICAgICQoXCIjdXBkYXRlLWZ1bGwtbmFtZVwiKS52YWwoc3R1ZGVudC5mdWxsTmFtZSk7XHJcbiAgICAkKFwiI3VwZGF0ZS10aGVzaXMtcmVnaXN0cmJsZVwiKS52YWwoc3R1ZGVudC5zdHVkZW50LnRoZXNpc1JlZ2lzdHJhYmxlID8gXCJ0cnVlXCIgOiBcImZhbHNlXCIpO1xyXG4gICAgJChcIiN1cGRhdGUtc3R1ZGVudC1tb2RhbFwiKS5tb2RhbCgnc2hvdycpO1xyXG59O1xyXG4iXX0=
